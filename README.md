## Модуль интеграции с CMS Tilda
Данный модуль обеспечивает взаимодействие между интернет-магазином на базе CMS Tilda и сервисом платежей [ХуткiГрош](https://hutkigrosh.by).
Выполнен как отдельный компонент, с которым Tilda взаимодействует через механизм [универсальной платёжной системы](https://help-ru.tilda.cc/payments/custom-payment-gateway),
и располагается на стороне разработчика сервиса ХуткiГрош
  
## Инструкция по настройке платежной системы в интернет-магазине
1. Зайдите в [личный кабинет](https://cmsgate.esas.by/cmsgate-tilda-hutkigrosh/config/login) для настройки интеграции. Для входа 
необходимо использовать авторизационные данные системы ХуткiГрош
    1. Укажите обязательные параметры
        * ЕРИП ID  – уникальный идентификатор ЕРИП услуги
        * Код услуги - код услуги в дереве ЕРИП. Используется при генерации QR-кода  
        * Email оповещение - включить информирование клиента по email при успешном выставлении счета (выполняется шлюзом Хуткiгрош)
        * Sms оповещение - включить информирование клиента по смс при успешном выставлении счета (выполняется шлюзом Хуткiгрош)    
        * Секция "Инструкция" - если включена, то на итоговом экране клиенту будет доступна пошаговая инструкция по оплате счета в ЕРИП
        * Секция QR-code - если включена, то на итоговом экране клиенту будет доступна оплата счета по QR-коду
        * Секция Webpay - если включена, то на итоговом экране клиенту отобразится кнопка для оплаты счета картой (переход на Webpay)            
        * Срок действия счета - как долго счет, будет доступен в ЕРИП для оплаты
        * Путь в дереве ЕРИП - путь для оплаты счета в дереве ЕРИП, который будет показан клиенту после оформления заказа (например, Платежи > Магазин > Заказы)
        * Текст успешного выставления счета - текст, отображаемый кленту после успешного выставления счета. Может содержать html. В тексте допустимо ссылаться на переменные @order_id, @order_number, @order_total, @order_currency, @order_fullname, @order_phone, @order_address
    1. Сохраните настройки 
    1. Скопируйте **API Secret**    
1. Зайдите в систему администрирования вашего магазина в Tilda
    1. Перейдите в `Настройки сайта → Платежные системы` и выберите пункт `«Универсальная платёжная система»`
    1. Из списка готовых шаблонов выберите `ХуткiГрош (ЕРИП Беларусь)`
    1. Укажите обязательные параметры
        * Логин  – логин в системе ХуткiГрош
        * Секрет для подписи заказа - значение скопированное в п.1.iii из поля **API Secret** 
        * URL страницы успеха - адрес страницы, на которую будет перенаправлен пользователь в случае успешной оплаты
        * URL страницы отказа - адрес страницы, на которую будет перенаправлен пользователь, если в процессе оплаты возникнут ошибки.        

